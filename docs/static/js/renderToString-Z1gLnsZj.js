import{a5 as $,a6 as P,i as _,a7 as N,a8 as h,a9 as T,aa as L,ab as d,F as k,ac as F,ad as z,ae as G,af as U,ag as p,ah as x,H as j,ai as D,aj as K,ak as W,n as q,x as I,al as J,am as Q,an as X,ao as Y,ap as Z,aq as ee,ar as re,as as te,at as se,au as ne,av as oe,d as R,s as v,aw as ae,r as V,ax as ie,c as le,b as fe,G as ue,f as S,l as ce,ay as pe,o as de}from"../../assets/index-DOi-xgW3.js";const me=K(",key,ref,innerHTML,textContent,ref_key,ref_for");function _e(e,r){let t="";for(const s in e){if(me(s)||W(s)||r==="textarea"&&s==="value")continue;const n=e[s];s==="class"?t+=` class="${he(n)}"`:s==="style"?t+=` style="${ye(n)}"`:s==="className"?t+=` class="${String(n)}"`:t+=ge(s,n,r)}return t}function ge(e,r,t){if(!Q(r))return"";const s=t&&(t.indexOf("-")>0||X(t))?e:Y[e]||e.toLowerCase();return Z(s)?ee(r)?` ${s}`:"":re(s)?r===""?` ${s}`:` ${s}="${p(r)}"`:(console.warn(`[@vue/server-renderer] Skipped rendering unsafe attribute name: ${s}`),"")}function he(e){return p(q(e))}function ye(e){if(!e)return"";if(d(e))return p(e);const r=I(Se(e));return p(J(r))}function Se(e){if(!x(e)&&te(e)){const r={};for(const t in e)t.startsWith(":--")?r[t.slice(1)]=se(e[t]):r[t]=e[t];return r}return e}function Te(e,r,t,s,n){e("<!--teleport start-->");const o=n.appContext.provides[N],a=o.__teleportBuffers||(o.__teleportBuffers={}),i=a[t]||(a[t]=[]),f=i.length;let c;if(s)r(e),c="<!--teleport start anchor--><!--teleport anchor-->";else{const{getBuffer:u,push:l}=E();l("<!--teleport start anchor-->"),r(l),l("<!--teleport anchor-->"),c=u()}i.splice(f,0,c),e("<!--teleport end-->")}{const e=ne(),r=(t,s)=>{let n;return(n=e[t])||(n=e[t]=[]),n.push(s),o=>{n.length>1?n.forEach(a=>a(o)):n[0](o)}};r("__VUE_INSTANCE_SETTERS__",t=>t),r("__VUE_SSR_SETTERS__",t=>t)}function Re(e,r){throw new Error("On-the-fly template compilation is not supported in the ESM build of @vue/server-renderer. All templates must be pre-compiled into render functions.")}const{createComponentInstance:Ce,setCurrentRenderingInstance:b,setupComponent:Ve,renderComponentRoot:B,normalizeVNode:be}=$;function E(){let e=!1;const r=[];return{getBuffer(){return r},push(t){const s=d(t);if(e&&s){r[r.length-1]+=t;return}r.push(t),e=s,(h(t)||x(t)&&t.hasAsync)&&(r.hasAsync=!0)}}}function M(e,r=null,t){const s=e.component=Ce(e,r,null),n=Ve(s,!0),o=h(n);let a=s.sp;return o||a?Promise.resolve(n).then(()=>{if(o&&(a=s.sp),a)return Promise.all(a.map(f=>f.call(s.proxy)))}).catch(T).then(()=>A(s,t)):A(s,t)}function A(e,r){const t=e.type,{getBuffer:s,push:n}=E();if(L(t)){let o=B(e);if(!t.props)for(const a in e.attrs)a.startsWith("data-v-")&&((o.props||(o.props={}))[a]="");y(n,e.subTree=o,e,r)}else{(!e.render||e.render===T)&&!e.ssrRender&&!t.ssrRender&&d(t.template)&&(t.ssrRender=Re(t.template));const o=e.ssrRender||t.ssrRender;if(o){let a=e.inheritAttrs!==!1?e.attrs:void 0,i=!1,f=e;for(;;){const u=f.vnode.scopeId;u&&(i||(a={...a},i=!0),a[u]="");const l=f.parent;if(l&&l.subTree&&l.subTree===f.vnode)f=l;else break}if(r){i||(a={...a});const u=r.trim().split(" ");for(let l=0;l<u.length;l++)a[u[l]]=""}const c=b(e);try{o(e.proxy,n,e,a,e.props,e.setupState,e.data,e.ctx)}finally{b(c)}}else e.render&&e.render!==T?y(n,e.subTree=B(e),e,r):(t.name||t.__file,n("<!---->"))}return s()}function y(e,r,t,s){const{type:n,shapeFlag:o,children:a,dirs:i,props:f}=r;switch(i&&(r.props=Ae(r,f,i)),n){case U:e(p(a));break;case z:e(a?`<!--${G(a)}-->`:"<!---->");break;case F:e(a);break;case k:r.slotScopeIds&&(s=(s?s+" ":"")+r.slotScopeIds.join(" ")),e("<!--[-->"),C(e,a,t,s),e("<!--]-->");break;default:o&1?Be(e,r,t,s):o&6?e(M(r,t,s)):o&64?$e(e,r,t,s):o&128&&y(e,r.ssContent,t,s)}}function C(e,r,t,s){for(let n=0;n<r.length;n++)y(e,be(r[n]),t,s)}function Be(e,r,t,s){const n=r.type;let{props:o,children:a,shapeFlag:i,scopeId:f}=r,c=`<${n}`;o&&(c+=_e(o,n)),f&&(c+=` ${f}`);let u=t,l=r;for(;u&&l===u.subTree;)l=u.vnode,l.scopeId&&(c+=` ${l.scopeId}`),u=u.parent;if(s&&(c+=` ${s}`),e(c+">"),!D(n)){let m=!1;o&&(o.innerHTML?(m=!0,e(o.innerHTML)):o.textContent?(m=!0,e(p(o.textContent))):n==="textarea"&&o.value&&(m=!0,e(p(o.value)))),m||(i&8?e(p(a)):i&16&&C(e,a,t,s)),e(`</${n}>`)}}function Ae(e,r,t){const s=[];for(let n=0;n<t.length;n++){const o=t[n],{dir:{getSSRProps:a}}=o;if(a){const i=a(o,e);i&&s.push(i)}}return j(r||{},...s)}function $e(e,r,t,s){const n=r.props&&r.props.to,o=r.props&&r.props.disabled;if(!n)return[];if(!d(n))return[];Te(e,a=>{C(a,r.children,t,s)},n,o||o==="",t)}const{isVNode:Ne}=$;function g(e,r,t){if(!e.hasAsync)return r+H(e);let s=r;for(let n=t;n<e.length;n+=1){const o=e[n];if(d(o)){s+=o;continue}if(h(o))return o.then(i=>(e[n]=i,g(e,s,n)));const a=g(o,s,0);if(h(a))return a.then(i=>(e[n]=i,g(e,"",n)));s=a}return s}function w(e){return g(e,"",0)}function H(e){let r="";for(let t=0;t<e.length;t++){let s=e[t];d(s)?r+=s:r+=H(s)}return r}async function O(e,r={}){if(Ne(e))return O(P({render:()=>e}),r);const t=_(e._component,e._props);t.appContext=e._context,e.provide(N,r);const s=await M(t),n=await w(s);if(await ke(r),r.__watcherHandles)for(const o of r.__watcherHandles)o();return n}async function ke(e){if(e.__teleportBuffers){e.teleports=e.teleports||{};for(const r in e.__teleportBuffers)e.teleports[r]=await w(await Promise.all([e.__teleportBuffers[r]]))}}oe();const xe=R({name:"SlotRender",abstract:!0,props:["vnode"],emits:{mounted(){return!0}},setup(e,{emit:r,slots:t}){return v(()=>{r("mounted")}),console.log(ae(e.vnode)),()=>t.default?.()}}),Ee=R({description:"vue: createSSRApp,renderToString 方法",__name:"renderToString",setup(e){const r=R({setup(){const a=V("111");return()=>pe("div",{onClick:()=>{console.log(2222222)}},`${a.value}`)}}),t=V(),s=ie(r,{id:1,test:"adasd"});async function n(){const a=await O(s);t.value.innerHTML=a}function o(){console.log("srMounted")}return v(()=>{n()}),(a,i)=>(de(),le(k,null,[fe("div",{ref_key:"divRef",ref:t},null,512),_(S(r)),i[0]||(i[0]=ue(" aaa ",-1)),_(S(xe),{onMounted:o},{default:ce(()=>[_(S(r))]),_:1})],64))}});export{Ee as default};
