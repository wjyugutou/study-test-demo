import{a5 as N,a6 as P,i as _,a7 as $,a8 as g,a9 as T,aa as L,ab as d,F as k,ac as F,ad as z,ae as G,af as U,ag as p,ah as x,H as W,ai as j,aj as D,ak as K,n as q,x as I,al as J,am as Q,an as X,ao as Y,ap as Z,aq as ee,ar as te,as as re,at as se,au as ne,av as oe,d as R,s as v,aw as ae,ax as ie,c as le,b as fe,G as ue,f as S,l as ce,ay as pe,r as V,o as de}from"../../assets/index-BaHEQj1m.js";const me=D(",key,ref,innerHTML,textContent,ref_key,ref_for");function _e(e,t){let r="";for(let s in e){if(me(s)||K(s)||t==="textarea"&&s==="value"||s.startsWith("."))continue;const n=e[s];s.startsWith("^")&&(s=s.slice(1)),s==="class"||s==="className"?r+=` class="${ge(n)}"`:s==="style"?r+=` style="${ye(n)}"`:r+=he(s,n,t)}return r}function he(e,t,r){if(!Q(t))return"";const s=r&&(r.indexOf("-")>0||X(r))?e:Y[e]||e.toLowerCase();return Z(s)?ee(t)?` ${s}`:"":te(s)?t===""?` ${s}`:` ${s}="${p(t)}"`:(console.warn(`[@vue/server-renderer] Skipped rendering unsafe attribute name: ${s}`),"")}function ge(e){return p(q(e))}function ye(e){if(!e)return"";if(d(e))return p(e);const t=I(Se(e));return p(J(t))}function Se(e){if(!x(e)&&re(e)){const t={};for(const r in e)r.startsWith(":--")?t[r.slice(1)]=se(e[r]):t[r]=e[r];return t}return e}function Te(e,t,r,s,n){e("<!--teleport start-->");const o=n.appContext.provides[$],a=o.__teleportBuffers||(o.__teleportBuffers={}),i=a[r]||(a[r]=[]),f=i.length;let c;if(s)t(e),c="<!--teleport start anchor--><!--teleport anchor-->";else{const{getBuffer:u,push:l}=E();l("<!--teleport start anchor-->"),t(l),l("<!--teleport anchor-->"),c=u()}i.splice(f,0,c),e("<!--teleport end-->")}{const e=ne(),t=(r,s)=>{let n;return(n=e[r])||(n=e[r]=[]),n.push(s),o=>{n.length>1?n.forEach(a=>a(o)):n[0](o)}};t("__VUE_INSTANCE_SETTERS__",r=>r),t("__VUE_SSR_SETTERS__",r=>r)}function Re(e,t){throw new Error("On-the-fly template compilation is not supported in the ESM build of @vue/server-renderer. All templates must be pre-compiled into render functions.")}const{createComponentInstance:Ce,setCurrentRenderingInstance:b,setupComponent:Ve,renderComponentRoot:B,normalizeVNode:be}=N;function E(){let e=!1;const t=[];return{getBuffer(){return t},push(r){const s=d(r);if(e&&s){t[t.length-1]+=r;return}t.push(r),e=s,(g(r)||x(r)&&r.hasAsync)&&(t.hasAsync=!0)}}}function M(e,t=null,r){const s=e.component=Ce(e,t,null),n=Ve(s,!0),o=g(n);let a=s.sp;return o||a?Promise.resolve(n).then(()=>{if(o&&(a=s.sp),a)return Promise.all(a.map(f=>f.call(s.proxy)))}).catch(T).then(()=>A(s,r)):A(s,r)}function A(e,t){const r=e.type,{getBuffer:s,push:n}=E();if(L(r)){let o=B(e);if(!r.props)for(const a in e.attrs)a.startsWith("data-v-")&&((o.props||(o.props={}))[a]="");y(n,e.subTree=o,e,t)}else{(!e.render||e.render===T)&&!e.ssrRender&&!r.ssrRender&&d(r.template)&&(r.ssrRender=Re(r.template));const o=e.ssrRender||r.ssrRender;if(o){let a=e.inheritAttrs!==!1?e.attrs:void 0,i=!1,f=e;for(;;){const u=f.vnode.scopeId;u&&(i||(a={...a},i=!0),a[u]="");const l=f.parent;if(l&&l.subTree&&l.subTree===f.vnode)f=l;else break}if(t){i||(a={...a});const u=t.trim().split(" ");for(let l=0;l<u.length;l++)a[u[l]]=""}const c=b(e);try{o(e.proxy,n,e,a,e.props,e.setupState,e.data,e.ctx)}finally{b(c)}}else e.render&&e.render!==T?y(n,e.subTree=B(e),e,t):(r.name||r.__file,n("<!---->"))}return s()}function y(e,t,r,s){const{type:n,shapeFlag:o,children:a,dirs:i,props:f}=t;switch(i&&(t.props=Ae(t,f,i)),n){case U:e(p(a));break;case z:e(a?`<!--${G(a)}-->`:"<!---->");break;case F:e(a);break;case k:t.slotScopeIds&&(s=(s?s+" ":"")+t.slotScopeIds.join(" ")),e("<!--[-->"),C(e,a,r,s),e("<!--]-->");break;default:o&1?Be(e,t,r,s):o&6?e(M(t,r,s)):o&64?Ne(e,t,r,s):o&128&&y(e,t.ssContent,r,s)}}function C(e,t,r,s){for(let n=0;n<t.length;n++)y(e,be(t[n]),r,s)}function Be(e,t,r,s){const n=t.type;let{props:o,children:a,shapeFlag:i,scopeId:f}=t,c=`<${n}`;o&&(c+=_e(o,n)),f&&(c+=` ${f}`);let u=r,l=t;for(;u&&l===u.subTree;)l=u.vnode,l.scopeId&&(c+=` ${l.scopeId}`),u=u.parent;if(s&&(c+=` ${s}`),e(c+">"),!j(n)){let m=!1;o&&(o.innerHTML?(m=!0,e(o.innerHTML)):o.textContent?(m=!0,e(p(o.textContent))):n==="textarea"&&o.value&&(m=!0,e(p(o.value)))),m||(i&8?e(p(a)):i&16&&C(e,a,r,s)),e(`</${n}>`)}}function Ae(e,t,r){const s=[];for(let n=0;n<r.length;n++){const o=r[n],{dir:{getSSRProps:a}}=o;if(a){const i=a(o,e);i&&s.push(i)}}return W(t||{},...s)}function Ne(e,t,r,s){const n=t.props&&t.props.to,o=t.props&&t.props.disabled;if(!n)return[];if(!d(n))return[];Te(e,a=>{C(a,t.children,r,s)},n,o||o==="",r)}const{isVNode:$e}=N;function h(e,t,r){if(!e.hasAsync)return t+H(e);let s=t;for(let n=r;n<e.length;n+=1){const o=e[n];if(d(o)){s+=o;continue}if(g(o))return o.then(i=>(e[n]=i,h(e,s,n)));const a=h(o,s,0);if(g(a))return a.then(i=>(e[n]=i,h(e,"",n)));s=a}return s}function w(e){return h(e,"",0)}function H(e){let t="";for(let r=0;r<e.length;r++){let s=e[r];d(s)?t+=s:t+=H(s)}return t}async function O(e,t={}){if($e(e))return O(P({render:()=>e}),t);const r=_(e._component,e._props);r.appContext=e._context,e.provide($,t);const s=await M(r),n=await w(s);if(await ke(t),t.__watcherHandles)for(const o of t.__watcherHandles)o();return n}async function ke(e){if(e.__teleportBuffers){e.teleports=e.teleports||{};for(const t in e.__teleportBuffers)e.teleports[t]=await w(await Promise.all([e.__teleportBuffers[t]]))}}oe();const xe=R({name:"SlotRender",abstract:!0,props:["vnode"],emits:{mounted(){return!0}},setup(e,{emit:t,slots:r}){return v(()=>{t("mounted")}),console.log(ae(e.vnode)),()=>r.default?.()}}),Ee=R({description:"vue: createSSRApp,renderToString 方法",__name:"renderToString",setup(e){const t=R({setup(){const a=V("111");return()=>pe("div",{onClick:()=>{console.log(2222222)}},`${a.value}`)}}),r=V(),s=ie(t,{id:1,test:"adasd"});async function n(){const a=await O(s);r.value.innerHTML=a}function o(){console.log("srMounted")}return v(()=>{n()}),(a,i)=>(de(),le(k,null,[fe("div",{ref_key:"divRef",ref:r},null,512),_(S(t)),i[0]||(i[0]=ue(" aaa ",-1)),_(S(xe),{onMounted:o},{default:ce(()=>[_(S(t))]),_:1})],64))}});export{Ee as default};
