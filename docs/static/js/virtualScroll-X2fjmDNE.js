import{d as _,c as m,k as x,$ as S,u as h,f as H,b as u,o as T,j as p,e as g,F as $,l as k,g as w,M as v,aA as B,s as C,V as N,Z as L,a0 as z}from"./vue-BNDGywnP.js";import{a as A}from"../../assets/index-ByPwO6BV.js";import{r as F}from"./lodash-DuwzciWb.js";import"./particles-DxQy181U.js";import"./shiki-CGx1dPWx.js";const P=_({name:"CssVirtualList",__name:"CssVirtualList",props:{itemHeight:{default:50}},setup(c){const e=c,d=H(()=>({containIntrinsicSize:`${e.itemHeight}px`}));return(i,a)=>(u(),m("div",{class:"css-virtual-list",style:S(h(d))},[x(i.$slots,"default",{},void 0,!0)],4))}}),j=A(P,[["__scopeId","data-v-5a3160e4"]]),D=["index"],E=_({name:"VirtualListItem",__name:"VirtualListItem",props:{index:{}},emits:["sizeChange"],setup(c,{emit:e}){const d=e,i=p();return T(()=>{d("sizeChange",i.value,c.index)}),(a,l)=>(u(),m("div",{ref_key:"div",ref:i,"h-fit":"",index:c.index},[x(a.$slots,"default")],8,D))}}),R=10,Z=_({name:"VirtualList",__name:"index",props:{viewCount:{},itemSize:{},height:{},dataSource:{}},setup(c){const e=c,d=p(),i=p(),a=p(0),l=B({itemHeight:{}}),o=p("0px"),f=p(e.dataSource.length*(e.itemSize??50)),y=H(()=>{const s=Math.min(e.dataSource.length-1,a.value+R);return e.dataSource.slice(a.value,s+1).map((n,t)=>({record:n,index:t+a.value}))});function V(s,n){let t=e.dataSource.length*(e.itemSize??50);l.itemHeight[n]=s.clientHeight;for(const r in l.itemHeight)t+=l.itemHeight[r]-50;f.value=t}function I(s){if(e.itemSize)return Math.floor(s/e.itemSize);let n=0,t=0;for(let r=0;r<e.dataSource.length&&(n+=l.itemHeight[r]||50,t++,console.log(n,Math.max(t-2,0)),!(n>=s));r++);return Math.max(t-2,0)}function b(s){if(e.itemSize)return`${s*e.itemSize}px`;let n=0;for(let t=0;t<a.value&&!(t>+a.value);t++)n+=l.itemHeight[t]||50;return`${n}px`}function M(s){const n=s.target;a.value=I(n.scrollTop),o.value=b(a.value)}return(s,n)=>{const t=E;return u(),m("div",{ref_key:"virtualList",ref:d,class:"virtualList",onScroll:M},[g("div",{ref_key:"virtualContent",ref:i,style:S({height:`${h(f)}px`,paddingTop:h(o)})},[(u(!0),m($,null,k(h(y),r=>(u(),w(t,{key:r.index,index:r.index,onSizeChange:V},{default:v(()=>[x(s.$slots,"default",{record:r.record,index:r.index})]),_:2},1032,["index"]))),128))],4)],544)}}}),Q=_({description:"虚拟列表",__name:"virtualScroll",setup(c){const e=Array.from({length:1e3}).map((d,i)=>({content:`但是价格法大师傅--${i}`,index:i,src:"",height:F(20,165)}));return(d,i)=>{const a=Z,l=j;return u(),m("div",null,[i[1]||(i[1]=g("h1",{"text-center":""}," 动态高度 ",-1)),C(a,{"data-source":h(e),class:"virtualList"},{default:v(({record:o,index:f})=>[g("div",{style:S({height:`${o.height}px`}),class:N({"bg-pink-400":o.index%2===0,"bg-blue-400":o.index%2!==0})},L(o)+"-- "+L(f),7)]),_:1},8,["data-source"]),C(l,{"h-200px":""},{default:v(()=>[(u(!0),m($,null,k(h(e),o=>(u(),m("div",{key:o.index},[...i[0]||(i[0]=[g("p",null,[z("5asdasdas "),g("br"),z(" 5")],-1)])]))),128))]),_:1})])}}});export{Q as default};
