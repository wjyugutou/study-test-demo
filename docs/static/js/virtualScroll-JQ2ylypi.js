import{d as _,c as m,J as v,x as S,f as h,C as z,o as u,y as T,s as w,r as p,b as g,F as H,k,h as B,l as x,aC as N,i as C,n as F,t as L,G as y}from"../../assets/index-BaHEQj1m.js";import{r as P}from"./random-BRp1soGr.js";import"./isObjectLike-DPoW-m9N.js";const A=_({name:"CssVirtualList",__name:"CssVirtualList",props:{itemHeight:{default:50}},setup(c){const e=c,d=z(()=>({containIntrinsicSize:`${e.itemHeight}px`}));return(i,a)=>(u(),m("div",{class:"css-virtual-list",style:S(h(d))},[v(i.$slots,"default",{},void 0,!0)],4))}}),D=T(A,[["__scopeId","data-v-5a3160e4"]]),E=["index"],G=_({name:"VirtualListItem",__name:"VirtualListItem",props:{index:{}},emits:["sizeChange"],setup(c,{emit:e}){const d=e,i=p();return w(()=>{d("sizeChange",i.value,c.index)}),(a,l)=>(u(),m("div",{ref_key:"div",ref:i,"h-fit":"",index:c.index},[v(a.$slots,"default")],8,E))}}),J=10,R=_({name:"VirtualList",__name:"index",props:{viewCount:{},itemSize:{},height:{},dataSource:{}},setup(c){const e=c,d=p(),i=p(),a=p(0),l=N({itemHeight:{}}),o=p("0px"),f=p(e.dataSource.length*(e.itemSize??50)),$=z(()=>{const s=Math.min(e.dataSource.length-1,a.value+J);return e.dataSource.slice(a.value,s+1).map((n,t)=>({record:n,index:t+a.value}))});function V(s,n){let t=e.dataSource.length*(e.itemSize??50);l.itemHeight[n]=s.clientHeight;for(const r in l.itemHeight)t+=l.itemHeight[r]-50;f.value=t}function I(s){if(e.itemSize)return Math.floor(s/e.itemSize);let n=0,t=0;for(let r=0;r<e.dataSource.length&&(n+=l.itemHeight[r]||50,t++,console.log(n,Math.max(t-2,0)),!(n>=s));r++);return Math.max(t-2,0)}function b(s){if(e.itemSize)return`${s*e.itemSize}px`;let n=0;for(let t=0;t<a.value&&!(t>+a.value);t++)n+=l.itemHeight[t]||50;return`${n}px`}function M(s){const n=s.target;a.value=I(n.scrollTop),o.value=b(a.value)}return(s,n)=>{const t=G;return u(),m("div",{ref_key:"virtualList",ref:d,class:"virtualList",onScroll:M},[g("div",{ref_key:"virtualContent",ref:i,style:S({height:`${h(f)}px`,paddingTop:h(o)})},[(u(!0),m(H,null,k(h($),r=>(u(),B(t,{key:r.index,index:r.index,onSizeChange:V},{default:x(()=>[v(s.$slots,"default",{record:r.record,index:r.index})]),_:2},1032,["index"]))),128))],4)],544)}}}),O=_({description:"虚拟列表",__name:"virtualScroll",setup(c){const e=Array.from({length:1e3}).map((d,i)=>({content:`但是价格法大师傅--${i}`,index:i,src:"",height:P(20,165)}));return(d,i)=>{const a=R,l=D;return u(),m("div",null,[i[1]||(i[1]=g("h1",{"text-center":""}," 动态高度 ",-1)),C(a,{"data-source":h(e),class:"virtualList"},{default:x(({record:o,index:f})=>[g("div",{style:S({height:`${o.height}px`}),class:F({"bg-pink-400":o.index%2===0,"bg-blue-400":o.index%2!==0})},L(o)+"-- "+L(f),7)]),_:1},8,["data-source"]),C(l,{"h-200px":""},{default:x(()=>[(u(!0),m(H,null,k(h(e),o=>(u(),m("div",{key:o.index},[...i[0]||(i[0]=[g("p",null,[y("5asdasdas "),g("br"),y(" 5")],-1)])]))),128))]),_:1})])}}});export{O as default};
