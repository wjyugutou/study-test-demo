import{d as g,i as l,I as L,o as d,a as h,x,Q as $,c as M,b as p,F as V,e as I,g as w,w as S,f as m,n as y,h as T,t as v,y as B}from"../../assets/index-24578d3d.js";import{r as P}from"./random-99138415.js";const j=["index"],F=g({__name:"VirtualListItem",props:{index:{}},emits:["sizeChange"],setup(_,{emit:e}){const{index:c}=_,s=e,a=l();return L(()=>{s("sizeChange",a.value,c)}),(n,u)=>(d(),h("div",{ref_key:"div",ref:a,"h-fit":"",index:n.index},[x(n.$slots,"default")],8,j))}}),N=10,O=g({name:"VirtualList",label:"虚拟列表",__name:"index",props:{viewCount:{},itemSize:{},height:{},dataSource:{}},setup(_){const e=_,c=l(),s=l(),a=l(0),n=$({itemHeight:{}}),u=l("0px"),f=l(e.dataSource.length*(e.itemSize??50)),z=M(()=>{const o=Math.min(e.dataSource.length-1,a.value+N);return e.dataSource.slice(a.value,o+1).map((i,t)=>({record:i,index:t+a.value}))});function C(o,i){let t=e.dataSource.length*(e.itemSize??50);n.itemHeight[i]=o.clientHeight;for(const r in n.itemHeight)t+=n.itemHeight[r]-50;f.value=t}function b(o){if(e.itemSize)return Math.floor(o/e.itemSize);let i=0,t=0;for(let r=0;r<e.dataSource.length&&(i+=n.itemHeight[r]||50,t++,console.log(i,Math.max(t-2,0)),!(i>=o));r++);return Math.max(t-2,0)}function H(o){if(e.itemSize)return`${o*e.itemSize}px`;let i=0;for(let t=0;t<a.value&&!(t>+a.value);t++)i+=n.itemHeight[t]||50;return`${i}px`}function k(o){const i=o.target;a.value=b(i.scrollTop),u.value=H(a.value)}return(o,i)=>{const t=F;return d(),h("div",{ref_key:"virtualList",ref:c,class:"virtualList",onScroll:k},[p("div",{ref_key:"virtualContent",ref:s,style:y({height:`${m(f)}px`,paddingTop:m(u)})},[(d(!0),h(V,null,I(m(z),r=>(d(),w(t,{key:r.index,index:r.index,onSizeChange:C},{default:S(()=>[x(o.$slots,"default",{record:r.record,index:r.index})]),_:2},1032,["index"]))),128))],4)],544)}}});const A=p("h1",{"text-center":""}," 动态高度 ",-1),D=g({name:"VirtualScroll",__name:"virtualScroll",setup(_){const e=Array.from({length:1e3}).map((c,s)=>({content:`但是价格法大师傅--${s}`,index:s,src:"",height:P(20,165)}));return(c,s)=>{const a=O;return d(),h("div",null,[A,T(a,{"data-source":m(e),class:"virtualList"},{default:S(({record:n,index:u})=>[p("div",{style:y({height:`${n.height}px`}),class:B({"bg-pink-400":n.index%2===0,"bg-blue-400":n.index%2!==0})},v(n)+"-- "+v(u),7)]),_:1},8,["data-source"])])}}});const R=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"}));export{R as _};
