import{N as F,O as B,P as z,h as y,Q as v,R,S as D,U as A,V as d,F as x,W as K,X as U,Y as G,Z as W,$ as p,a0 as j,a1 as I,a2 as M,a3 as Q,a4 as X,a5 as Y,a6 as Z,a7 as q,a8 as J,p as ee,n as re,a9 as te,aa as se,d as T,D as E,ab as ne,i as V,ac as oe,o as ae,a as ie,b as le,f as h,v as fe,w as ue,ad as ce}from"../../assets/index-05tj2T3Y.js";const pe=F(",key,ref,innerHTML,textContent,ref_key,ref_for");function de(e,r){let t="";for(const s in e){if(pe(s)||Q(s)||r==="textarea"&&s==="value")continue;const a=e[s];s==="class"?t+=` class="${ye(a)}"`:s==="style"?t+=` style="${ge(a)}"`:t+=me(s,a,r)}return t}function me(e,r,t){if(!_e(r))return"";const s=t&&(t.indexOf("-")>0||X(t))?e:Y[e]||e.toLowerCase();return Z(s)?q(r)?` ${s}`:"":J(s)?r===""?` ${s}`:` ${s}="${p(r)}"`:(console.warn(`[@vue/server-renderer] Skipped rendering unsafe attribute name: ${s}`),"")}function _e(e){if(e==null)return!1;const r=typeof e;return r==="string"||r==="number"||r==="boolean"}function ye(e){return p(ee(e))}function ge(e){if(!e)return"";if(d(e))return p(e);const r=re(e);return p(te(r))}function he(e,r,t,s,a){e("<!--teleport start-->");const n=a.appContext.provides[v],o=n.__teleportBuffers||(n.__teleportBuffers={}),i=o[t]||(o[t]=[]),f=i.length;let c;if(s)r(e),c="<!--teleport anchor-->";else{const{getBuffer:u,push:l}=H();r(l),l("<!--teleport anchor-->"),c=u()}i.splice(f,0,c),e("<!--teleport end-->")}let b,$="__VUE_INSTANCE_SETTERS__";(b=B()[$])||(b=B()[$]=[]),b.push(e=>e);function be(e,r){throw new Error("On-the-fly template compilation is not supported in the ESM build of @vue/server-renderer. All templates must be pre-compiled into render functions.")}const{createComponentInstance:Te,setCurrentRenderingInstance:w,setupComponent:Re,renderComponentRoot:N,normalizeVNode:Se}=M;function H(){let e=!1;const r=[];return{getBuffer(){return r},push(t){const s=d(t);e&&s?r[r.length-1]+=t:r.push(t),e=s,(R(t)||se(t)&&t.hasAsync)&&(r.hasAsync=!0)}}}function P(e,r=null,t){const s=Te(e,r,null),a=Re(s,!0),n=R(a),o=s.sp;if(n||o){let i=n?a:Promise.resolve();return o&&(i=i.then(()=>Promise.all(o.map(f=>f.call(s.proxy)))).catch(()=>{})),i.then(()=>k(s,t))}else return k(s,t)}function k(e,r){const t=e.type,{getBuffer:s,push:a}=H();if(D(t)){let n=N(e);if(!t.props)for(const o in e.attrs)o.startsWith("data-v-")&&((n.props||(n.props={}))[o]="");g(a,e.subTree=n,e,r)}else{(!e.render||e.render===A)&&!e.ssrRender&&!t.ssrRender&&d(t.template)&&(t.ssrRender=be(t.template));for(const o of e.scope.effects)o.computed&&(o.computed._dirty=!0,o.computed._cacheable=!0);const n=e.ssrRender||t.ssrRender;if(n){let o=e.inheritAttrs!==!1?e.attrs:void 0,i=!1,f=e;for(;;){const u=f.vnode.scopeId;u&&(i||(o={...o},i=!0),o[u]="");const l=f.parent;if(l&&l.subTree&&l.subTree===f.vnode)f=l;else break}r&&(i||(o={...o}),o[r.trim()]="");const c=w(e);try{n(e.proxy,a,e,o,e.props,e.setupState,e.data,e.ctx)}finally{w(c)}}else e.render&&e.render!==A?g(a,e.subTree=N(e),e,r):(t.name||t.__file,a("<!---->"))}return s()}function g(e,r,t,s){const{type:a,shapeFlag:n,children:o}=r;switch(a){case W:e(p(o));break;case U:e(o?`<!--${G(o)}-->`:"<!---->");break;case K:e(o);break;case x:r.slotScopeIds&&(s=(s?s+" ":"")+r.slotScopeIds.join(" ")),e("<!--[-->"),S(e,o,t,s),e("<!--]-->");break;default:n&1?Ce(e,r,t,s):n&6?e(P(r,t,s)):n&64?Ae(e,r,t,s):n&128&&g(e,r.ssContent,t,s)}}function S(e,r,t,s){for(let a=0;a<r.length;a++)g(e,Se(r[a]),t,s)}function Ce(e,r,t,s){const a=r.type;let{props:n,children:o,shapeFlag:i,scopeId:f,dirs:c}=r,u=`<${a}`;c&&(n=Be(r,n,c)),n&&(u+=de(n,a)),f&&(u+=` ${f}`);let l=t,m=r;for(;l&&m===l.subTree;)m=l.vnode,m.scopeId&&(u+=` ${m.scopeId}`),l=l.parent;if(s&&(u+=` ${s}`),e(u+">"),!j(a)){let _=!1;n&&(n.innerHTML?(_=!0,e(n.innerHTML)):n.textContent?(_=!0,e(p(n.textContent))):a==="textarea"&&n.value&&(_=!0,e(p(n.value)))),_||(i&8?e(p(o)):i&16&&S(e,o,t,s)),e(`</${a}>`)}}function Be(e,r,t){const s=[];for(let a=0;a<t.length;a++){const n=t[a],{dir:{getSSRProps:o}}=n;if(o){const i=o(n,e);i&&s.push(i)}}return I(r||{},...s)}function Ae(e,r,t,s){const a=r.props&&r.props.to,n=r.props&&r.props.disabled;if(!a)return[];if(!d(a))return[];he(e,o=>{S(o,r.children,t,s)},a,n||n==="",t)}const{isVNode:Ve}=M;async function C(e){if(e.hasAsync){let r="";for(let t=0;t<e.length;t++){let s=e[t];R(s)&&(s=await s),d(s)?r+=s:r+=await C(s)}return r}else return O(e)}function O(e){let r="";for(let t=0;t<e.length;t++){let s=e[t];d(s)?r+=s:r+=O(s)}return r}async function L(e,r={}){if(Ve(e))return L(z({render:()=>e}),r);const t=y(e._component,e._props);t.appContext=e._context,e.provide(v,r);const s=await P(t),a=await C(s);if(await $e(r),r.__watcherHandles)for(const n of r.__watcherHandles)n();return a}async function $e(e){if(e.__teleportBuffers){e.teleports=e.teleports||{};for(const r in e.__teleportBuffers)e.teleports[r]=await C(await Promise.all([e.__teleportBuffers[r]]))}}const we=T({name:"SlotRender",abstract:!0,props:["vnode"],emits:{mounted(){return!0}},setup(e,{emit:r,slots:t}){return E(()=>{r("mounted")}),console.log(ne(e.vnode)),()=>{var s;return(s=t.default)==null?void 0:s.call(t)}}}),ke=T({description:"vue: createSSRApp,renderToString 方法",__name:"renderToString",setup(e){const r=T({setup(o){const i=V("111");return()=>ce("div",{onClick:()=>{console.log(2222222)}},`${i.value}`)}}),t=V(),s=oe(r,{id:1,test:"adasd"});async function a(){const o=await L(s);t.value.innerHTML=o}function n(){console.log("srMounted")}return E(()=>{a()}),(o,i)=>(ae(),ie(x,null,[le("div",{ref_key:"divRef",ref:t},null,512),y(h(r)),fe(" aaa "),y(h(we),{onMounted:n},{default:ue(()=>[y(h(r))]),_:1})],64))}});export{ke as default};
